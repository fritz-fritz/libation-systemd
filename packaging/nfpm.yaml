name: libation-systemd
arch: all
platform: linux
version: ${TAG_VERSION}
section: misc
priority: optional
maintainer: FRITZ|FRITZ <code@fritztech.net>
description: |
  User systemd units and helpers to mount S3 storage via rclone
  and launch Libation with warm caches and clean teardown.
homepage: https://github.com/fritz-fritz/libation-systemd
license: GPL-3.0-or-later

contents:
  # systemd user units
  - src: systemd/user/
    dst: /usr/share/libation-systemd/systemd/user
    type: tree

  # env template and setup helper
  - src: config/env.example
    dst: /usr/share/libation-systemd/env.example
    file_info:
      mode: 0644
  - src: scripts/setup-libation-systemd
    dst: /usr/bin/setup-libation-systemd
    file_info:
      mode: 0755
  - src: scripts/migrate-s3.sh
    dst: /usr/share/libation-systemd/migrate-s3.sh
    file_info:
      mode: 0755

depends:
  - systemd
  - fuse3
  - rclone (>= 1.60)
  - libation

overrides:
  deb:
    recommends:
      - libnotify-bin
  rpm:
    recommends:
      - libnotify

scripts:
  postinstall: ./scripts/postinstall.sh
